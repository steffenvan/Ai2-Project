<?xml version="1.0" encoding="UTF-8"?>
<algorithms version="110505">
<algorithm name="SectLabel" version="110505">
<variant no="0" confidence="0.000000">
<title confidence="0.904962625">
Estimation of Consistent
Probabilistic Context-free Grammars
Mark-Jan Nederhof
Max Planck Institute
for Psycholinguistics
P.O. Box 310
NL-6500 AH Nijmegen
The Netherlands
</title>
<email confidence="0.97562">
MarkJan.Nederhof@mpi.nl
</email>
<sectionHeader confidence="0.998374" genericHeader="abstract">
Abstract
</sectionHeader>
<bodyText confidence="0.999947571428572">
We consider several empirical estimators
for probabilistic context-free grammars,
and show that the estimated grammars
have the so-called consistency property,
under the most general conditions. Our
estimators include the widely applied ex-
pectation maximization method, used to
estimate probabilistic context-free gram-
mars on the basis of unannotated corpora.
This solves a problem left open in the lit-
erature, since for this method the consis-
tency property has been shown only under
restrictive assumptions on the rules of the
source grammar.
</bodyText>
<sectionHeader confidence="0.999515" genericHeader="keywords">
1 Introduction
</sectionHeader>
<bodyText confidence="0.9995698">
Probabilistic context-free grammars are one of the
most widely used formalisms in current work in sta-
tistical natural language parsing and stochastic lan-
guage modeling. An important property for a proba-
bilistic context-free grammar is that it be consistent,
that is, the grammar should assign probability of one
to the set of all finite strings or parse trees that it
generates. In other words, the grammar should not
lose probability mass with strings or trees of infinite
length.
Several methods for the empirical estimation of
probabilistic context-free grammars have been pro-
posed in the literature, based on the optimization of
some function on the probabilities of the observed
data, such as the maximization of the likelihood of
</bodyText>
<author confidence="0.278631">
Giorgio Satta
</author>
<affiliation confidence="0.6758975">
Dept. of Information Engineering
University of Padua
</affiliation>
<address confidence="0.422907">
via Gradenigo, 6/A
I-35131 Padova
Italy
</address>
<email confidence="0.856627">
satta@dei.unipd.it
</email>
<bodyText confidence="0.999561941176471">
a tree bank or a corpus of unannotated sentences. It
has been conjectured in (Wetherell, 1980) that these
methods always provide probabilistic context-free
grammars with the consistency property. A first re-
sult in this direction was presented in (Chaudhuri et
al., 1983), by showing that a probabilistic context-
free grammar estimated by maximizing the likeli-
hood of a sample of parse trees is always consistent.
In later work by (S´anchez and Benedi, 1997)
and (Chi and Geman, 1998), the result was in-
dependently extended to expectation maximization,
which is an unsupervised method exploited to es-
timate probabilistic context-free grammars by find-
ing local maxima of the likelihood of a sample of
unannotated sentences. The proof in (S´anchez and
Benedi, 1997) makes use of spectral analysis of ex-
pectation matrices, while the proof in (Chi and Ge-
man, 1998) is based on a simpler counting argument.
Both these proofs assume restrictions on the un-
derlying context-free grammars. More specifically,
in (Chi and Geman, 1998) empty rules and unary
rules are not allowed, thus excluding infinite ambi-
guity, that is, the possibility that some string in the
input sample has an infinite number of derivations in
the grammar. The treatment of general form context-
free grammars has been an open problem so far.
In this paper we consider several estimation meth-
ods for probabilistic context-free grammars, and we
show that the resulting grammars have the consis-
tency property. Our proofs are applicable under
the most general conditions, and our results also
include the expectation maximization method, thus
solving the open problem discussed above. We use
an alternative proof technique with respect to pre-
</bodyText>
<page confidence="0.980057">
343
</page>
<note confidence="0.995421">
Proceedings of the Human Language Technology Conference of the North American Chapter of the ACL, pages 343–350,
New York, June 2006. c�2006 Association for Computational Linguistics
</note>
<bodyText confidence="0.996142692307692">
vious work, based on an already known renormal-
ization construction for probabilistic context-free
grammars, which has been used in the context of
language modeling.
The structure of this paper is as follows. We pro-
vide some preliminary definitions in Section 2, fol-
lowed in Section 3 by a brief overview of the esti-
mation methods we investigate in this paper. In Sec-
tion 4 we prove some properties of a renormaliza-
tion technique for probabilistic context-free gram-
mars, and use this property to show our main results
in Section 5. Section 6 closes with some concluding
remarks.
</bodyText>
<sectionHeader confidence="0.990612" genericHeader="introduction">
2 Preliminaries
</sectionHeader>
<bodyText confidence="0.9860375625">
In this paper we use mostly standard notation, as for
instance in (Hopcroft and Ullman, 1979) and (Booth
and Thompson, 1973), which we summarize below.
A context-free grammar (CFG) is a 4-tuple G =
(N, E, 5, R) where N and E are finite disjoint sets
of nonterminal and terminal symbols, respectively,
5 ∈ N is the start symbol and R is a finite set of
rules. Each rule has the form A → α, where A ∈ N
and α ∈ (E ∪ N)*. We write V for set E ∪ N.
Each CFG G is associated with a left-most de-
rive relation ⇒, defined on triples consisting of two
strings -y, 6 ∈ V* and a rule 7r ∈ R. We write -y π⇒ 6
if and only if -y = uA-y&apos; and 6 = uα-y&apos;, for some
u ∈ E*, -y&apos; ∈ V *, and 7r = (A → α). A left-
most derivation for G is a string d = 7r1 · · · 7rm,
m ≥ 0, such that -y0 ⇒ -y1
</bodyText>
<equation confidence="0.917195">
π1 ⇒ · · · πm
</equation>
<bodyText confidence="0.912312233333333">
π2 ⇒ -ym, for
some -y0, ... ,-ym ∈ V *; d = ε (where ε denotes
the empty string) is also a left-most derivation. In
the remainder of this paper, we will let the term
derivation always refer to left-most derivation. If
-y0 ⇒ · · · πm
π1 ⇒ -ym for some -y0, ... ,-ym ∈ V *, then
we say that d = 7r1 · · · 7rm derives -ym from -y0 and
we write -y0 ⇒ -ym; d = ε derives any -y0 ∈ V * from
d
itself.
A (left-most) derivation d such that 5 ⇒d w,
w ∈ E*, is called a complete derivation. If d is
a complete derivation, we write y(d) to denote the
(unique) string w ∈ E* such that 5 ⇒d w. We
define D(G) to be the set of all complete deriva-
tions for G. The language generated by G is the set
of all strings derived by complete derivations, i.e.,
L(G) = {y(d)  |d ∈ D(G)}. It is well-known that
there is a one-to-one correspondence between com-
plete derivations and parse trees for strings in L(G).
For X ∈ V and α ∈ V *, we write f(X, α) to
denote the number of occurrences of X in α. For
(A → α) ∈ R and a derivation d, f(A → α, d)
denotes the number of occurrences of A → α in d.
We let f(A, d) = Eα f(A → α, d).
A probabilistic CFG (PCFG) is a pair G =
(G, PG), where G is a CFG and PG is a function
from R to real numbers in the interval [0, 1]. We
say that G is proper if, for every A ∈ N, we have
</bodyText>
<equation confidence="0.6932665">
E PG(A → α) = 1. (1)
A—*α
</equation>
<bodyText confidence="0.998405666666667">
Function PG can be used to assign probabilities to
derivations of the underlying CFG G, in the follow-
ing way. For d = 7r1 · · · 7rm ∈ R*, m ≥ 0, we define
</bodyText>
<equation confidence="0.985183444444445">
PG(d) = �m PG(7ri). (2)
i=1
Note that PG(ε) = 1. The probability of a string
w ∈ E* is defined as
PG(w) = � PG(d). (3)
y(d)=w
A PCFG is consistent if
E PG(w) = 1. (4)
w
</equation>
<bodyText confidence="0.999577666666667">
Consistency implies that the PCFG defines a proba-
bility distribution over both sets D(G) and L(G).
If a PCFG is proper, then consistency means that
no probability mass is lost in derivations of infinite
length. All PCFGs in this paper are implicitly as-
sumed to be proper, unless otherwise stated.
</bodyText>
<sectionHeader confidence="0.814771" genericHeader="method">
3 Estimation of PCFGs
</sectionHeader>
<bodyText confidence="0.999745555555556">
In this section we give a brief overview of some esti-
mation methods for PCFGs. These methods will be
later investigated to show that they always provide
consistent PCFGs.
In natural language processing applications, esti-
mation of a PCFG is usually carried out on the ba-
sis of a tree bank, which in this paper we assume to
be a sample, that is, a finite multiset, of complete
derivations. Let D be such a sample, and let D be
</bodyText>
<page confidence="0.998145">
344
</page>
<bodyText confidence="0.999927666666667">
the underlying set of derivations. For d E D, we
let f(d, D) be the multiplicity of d in D, that is, the
number of occurrences of d in D. We define
</bodyText>
<equation confidence="0.976484666666667">
f(A → α, D) =
X f(d, D) · f(A → α, d), (5)
dED
</equation>
<bodyText confidence="0.999285857142857">
and let f(A, D) = Pα f(A → α, D).
Consider a CFG G = (N, Σ, R, S) defined by
all and only the nonterminals, terminals and rules
observed in D. The criterion of maximum likeli-
hood estimation (MLE) prescribes the construction
of a PCFG G = (G, pG) such that pG maximizes the
likelihood of D, defined as
</bodyText>
<equation confidence="0.9670005">
pG(D) = Y pG(d)f(d,D), (6)
dED
</equation>
<bodyText confidence="0.99986675">
subject to the properness conditions Pα pG(A →
α) = 1 for each A E N. The maximization problem
above has a unique solution, provided by the estima-
tor (see for instance (Chi and Geman, 1998))
</bodyText>
<equation confidence="0.9940495">
pG(A → α) = f(A → α, D). (7)
f (A, D)
</equation>
<bodyText confidence="0.999517692307692">
We refer to this as the supervised MLE method.
In applications in which a tree bank is not avail-
able, one might still use the MLE criterion to train
a PCFG in an unsupervised way, on the basis of a
sample of unannotated sentences, also called a cor-
pus. Let us call C such a sample and C the underly-
ing set of sentences. For w E C, we let f(w, C) be
the multiplicity of w in C.
Assume a CFG G = (N, Σ, R, S) that is able
to generate all of the sentences in C, and possibly
more. The MLE criterion prescribes the construc-
tion of a PCFG G = (G, pG) such that pG maxi-
mizes the likelihood of C, defined as
</bodyText>
<equation confidence="0.959668">
pG(C) = Y pG(w)f(w,C), (8)
wEC
</equation>
<bodyText confidence="0.9997715">
subject to the properness conditions as in the super-
vised case above. The above maximization prob-
lem provides a system of |R |nonlinear equations
(see (Chi and Geman, 1998))
</bodyText>
<equation confidence="0.983526">
pG(A → α) =
PwEC f(w, C) · EpG(d  |w) f(A → α, d) , (9)
PwEC f (w, C) · EpG(d  |w) f (A, d)
</equation>
<bodyText confidence="0.999956263157895">
where Ep denotes an expectation computed under
distribution p, and pG(d  |w) is the probability of
derivation d conditioned by sentence w (so that
pG(d  |w) &gt; 0 only if y(d) = w). The solution to
the above system is not unique, because of the non-
linearity. Furthermore, each solution of (9) identi-
fies a point where the curve in (8) has partial deriva-
tives of zero, but this does not necessarily corre-
spond to a local maximum, let alone an absolute
maximum. (A point with partial derivatives of zero
that is not a local maximum could be a local min-
imum or even a so-called saddle point.) In prac-
tice, this system is typically solved by means of an
iterative algorithm called inside/outside (Charniak,
1993), which implements the expectation maximiza-
tion (EM) method (Dempster et al., 1977). Starting
with an initial function pG that probabilistically ex-
tends G, a so-called growth transformation is com-
puted, defined as
</bodyText>
<equation confidence="0.99906025">
pG(A → α) =
r ( pG(d)
G-�wEC f lw, C)· Py(d)=w pG(w) f (A α, d)
EWEC
10)
pG(d) (AlAd)
G-�wEG f (w, C)· Py(d)=w f
PG(w) `
</equation>
<bodyText confidence="0.976915791666667">
Following (Baum, 1972), one can show that
pG(C) ≥ pG(C). Thus, by iterating the growth trans-
formation above, we are guaranteed to reach a local
maximum for (8), or possibly a saddle point. We
refer to this as the unsupervised MLE method.
We now discuss a third estimation method for
PCFGs, which was proposed in (Corazza and Satta,
2006). This method can be viewed as a general-
ization of the supervised MLE method to probabil-
ity distributions defined over infinite sets of com-
plete derivations. Let D be an infinite set of com-
plete derivations using nonterminal symbols in N,
start symbol S E N and terminal symbols in Σ.
We assume that the set of rules that are observed
in D is drawn from some finite set R. Let pD be
a probability distribution defined over D, that is,
a function from set D to interval [0, 1] such that
PdED pD(d) = 1.
Consider the CFG G = (N, Σ, R, S). Note that
D ⊆ D(G). We wish to extend G to some PCFG
G = (G, pG) in such a way that pD is approxi-
mated by pG (viewed as a distribution over complete
derivations) as well as possible according to some
criterion. One possible criterion is minimization of
</bodyText>
<page confidence="0.995912">
345
</page>
<bodyText confidence="0.9992845">
the cross-entropy between pD and pG, defined as
the expectation, under distribution pD, of the infor-
mation of the derivations in D computed under dis-
tribution pG, that is
</bodyText>
<equation confidence="0.888067">
�= − pD(d) · log pG(d). (11)
dED
</equation>
<bodyText confidence="0.999952363636364">
We thus want to assign to the parameters pG(A →
α), A → α ∈ R, the values that minimize (11), sub-
ject to the conditions Eα pG(A → α) = 1 for each
A ∈ N. Note that minimization of the cross-entropy
above is equivalent to minimization of the Kullback-
Leibler distance between pD and pG. Also note that
the likelihood of an infinite set of derivations would
always be zero and therefore cannot be considered
here.
The solution to the above minimization problem
provides the estimator
</bodyText>
<equation confidence="0.991983">
EpD f(A → α, d)
pG(A → α) = EpD f(A, d) . (12)
</equation>
<bodyText confidence="0.9999629">
A proof of this result appears in (Corazza and Satta,
2006), and is briefly summarized in Appendix A,
in order to make this paper self-contained. We call
the above estimator the cross-entropy minimization
method.
The cross-entropy minimization method can be
viewed as a generalization of the supervised MLE
method in (7), as shown in what follows. Let D and
D be defined as for the supervised MLE method. We
define a distribution over D as
</bodyText>
<equation confidence="0.998553">
pD(d) = f(d, D)
|D |.(13)
</equation>
<bodyText confidence="0.992967">
Distribution pD is usually called the empirical dis-
tribution associated with D. Applying the estimator
in (12) to pD, we obtain
</bodyText>
<equation confidence="0.990194142857143">
pG(A → α) =
EdED pD(d) · f(A → α, d)
EdED pD(d) · f(A, d)
EdED f (D�) · f (A → α, d)
EdED f (D;) · f (A, d)
EdED f(d, D) · f(A → α, d) (14)
EdED f (d, D) · f (A, d)
</equation>
<bodyText confidence="0.999883">
This is the supervised MLE estimator in (7). This re-
minds us of the well-known fact that maximizing the
likelihood of a (finite) sample through a PCFG dis-
tribution amounts to minimizing the cross-entropy
between the empirical distribution of the sample and
the PCFG distribution itself.
</bodyText>
<sectionHeader confidence="0.998925" genericHeader="method">
4 Renormalization
</sectionHeader>
<bodyText confidence="0.9994755">
In this section we recall a renormalization technique
for PCFGs that was used before in (Abney et al.,
1999), (Chi, 1999) and (Nederhof and Satta, 2003)
for different purposes, and is exploited in the next
section to prove our main results. In the remainder
of this section, we assume a fixed, not necessarily
proper PCFG G = (G, pG), with G = (N, Σ, S, R).
We define the renormalization of G as the PCFG
</bodyText>
<equation confidence="0.9618456">
R(G) = (G, p7z) with p7z specified by
p7z(A → α) =
Ed,w pG(α d ⇒w)
pG(A → α) · . (15)
Ed,w pG(A ⇒d w)
</equation>
<bodyText confidence="0.996937">
It is not difficult to see that R(G) is a proper PCFG.
We now show an important property of R(G), dis-
cussed before in (Nederhof and Satta, 2003) in the
context of so-called weighted context-free gram-
mars.
Lemma 1 For each derivation d with A ⇒d w, A ∈
N and w ∈ Σ*, we have
</bodyText>
<equation confidence="0.9329995">
p7z(A ⇒d w) = pG(A ⇒d wd) (16)
Ed/,w/ pG (A ⇒w,)
</equation>
<bodyText confidence="0.998652923076923">
Proof. The proof is by induction on the length of d,
written |d|. If |d |= 1 we must have d = (A → w),
and thus p7z(d) = p7z(A → w). In this case, the
statement of the lemma directly follows from (15).
Assume now |d |&gt; 1 and let π = (A → α)
be the first rule used in d. Note that there must
be at least one nonterminal symbol in α. We can
then write α as u0A1u1A2 · · · uq_1Aquq, for q ≥ 1,
Ai ∈ N, 1 ≤ i ≤ q, and uj ∈ Σ*, 0 ≤
j ≤ q. In words, A1, ... , Aq are all of the occur-
rences of nonterminals in α, as they appear from
left to right. Consequently, we can write d in the
form d = π · d1 · · · dq for some derivations di,
</bodyText>
<equation confidence="0.7803635">
1 ≤ i ≤ q, with Ai ⇒ wi, |di |≥ 1 and with
di
H(pD ||pG) = EpD log pG(d)
1
346
w = u0w1u1w2 · · · uq−1wquq. Below we use the
fact that pR(uj ⇒ uj) = pG(uj ε⇒ uj) = 1 for
ε
</equation>
<bodyText confidence="0.998974333333333">
each j with 0 ≤ j ≤ q, and further using the def-
inition of pR and the inductive hypothesis, we can
write
</bodyText>
<equation confidence="0.999469609756098">
pR(A ⇒d w) =
= pR(A → α) ·
E d0,w0 pG(α d0 ⇒ w&apos;)
= pG(A → α) · ·
0
Ed0,w0 pG (A ⇒ w&apos;)
pR(Ai ⇒ wi)
d�
E d0,w0 pG(α d0 ⇒ w&apos;)
= pG(A → α) · ·
0
Ed0,w0 pG (A ⇒ w&apos;)
pG(Ai ⇒ wi)
d�
d0
Ed0,w0 pG (Ai ⇒ w&apos;)
Ed0,w0 pG(α d0 ⇒ w&apos;)
= pG(A → α) ·
0
Ed0,w0 pG (A ⇒ w&apos;)
q d�
ni=1 pG(Ai 4 wi)
·
nqd0
1 Ed0 w0 pG(Ai ⇒ w&apos;)
E d0,w0 pG(α d0 ⇒ w&apos;)
= pG(A → α) · ·
0
Ed0,w0 pG (A ⇒ w&apos;)
q d�
ni=1 pG(Ai 4 wi)
·
0
Ed0,w0 pG (α ⇒ w&apos;)
pG(A → α) · n? 1 pG
Z=1 ·
d0
Ed0,w0 pG (A ⇒ w&apos;)
pG(A ⇒d w) .(17)
0
Ed0,w0 pG(A ⇒ w&apos;)
</equation>
<bodyText confidence="0.997254">
As an easy corollary of Lemma 1, we have that
R(G) is a consistent PCFG, as we can write
</bodyText>
<equation confidence="0.996465">
E pR(S ⇒d w) =
d,w
pG(S d⇒ w)
0
Ed0,w0 pG(S ⇒ w&apos;)
Ed,w pG(S d ⇒ w)
Ed0,w0 pG(S d0 ⇒ w&apos;)
</equation>
<sectionHeader confidence="0.98949" genericHeader="method">
5 Consistency
</sectionHeader>
<bodyText confidence="0.998754714285714">
In this section we prove the main results of this
paper, namely that all of the estimation methods
discussed in Section 3 always provide consistent
PCFGs. We start with a technical lemma, central
to our results, showing that a PCFG that minimizes
the cross-entropy with a distribution over any set of
derivations must be consistent.
</bodyText>
<construct confidence="0.99346325">
Lemma 2 Let G = (G, pG) be a proper PCFG
and let pD be a probability distribution defined over
some set D ⊆ D(G). If G minimizes function
H(pD  ||pG), then G is consistent.
</construct>
<listItem confidence="0.98968075">
Proof. Let G = (N, E, S, R), and assume that G is
not consistent. We establish a contradiction. Since G
is not consistent, we must have Ed,w pG(S ⇒d w) &lt;
1. Let then R(G) = (G, pR) be the renormalization
</listItem>
<bodyText confidence="0.832338">
of G, defined as in (15). For any derivation S d⇒ w,
w ∈ E∗, with d in D, we can use Lemma 1 and
write
</bodyText>
<equation confidence="0.9982526">
pR(S ⇒d w) =
1
= d0 ·pG (S ⇒d w)
Ed0,w0 pG(S ⇒ w&apos;)
&gt; pG(S ⇒d w). (19)
</equation>
<bodyText confidence="0.999549222222222">
In words, every complete derivation d in D has a
probability in R(G) that is strictly greater than in
G. But this means H(pD ||pR) &lt; H(pD  ||pG),
against our hypothesis. Therefore, G is consistent
and pG is a probability distribution over set D(G).
Thus function H(pD  ||pG) can be interpreted as the
cross-entropy. (Observe that in the statement of the
lemma we have avoided the term ‘cross-entropy’,
since cross-entropies are only defined for probability
distributions.)
Lemma 2 directly implies that the cross-entropy
minimization method in (12) always provides a con-
sistent PCFG, since it minimizes cross-entropy for a
distribution defined over a subset of D(G). We have
already seen in Section 3 that the supervised MLE
method is a special case of the cross-entropy min-
imization method. Thus we can also conclude that
a PCFG trained with the supervised MLE method is
</bodyText>
<equation confidence="0.912425">
pR(Ai ⇒ wi)
d�
� q
i=1
77q77
·11
i=1
� q
·
i=1
·
�=
d,w
= 1. (18)
</equation>
<page confidence="0.994187">
347
</page>
<bodyText confidence="0.9996047">
always consistent. This provides an alternative proof
of a property that was first shown in (Chaudhuri et
al., 1983), as discussed in Section 1.
We now prove the same result for the unsuper-
vised MLE method, without any restrictive assump-
tion on the rules of our CFGs. This solves a problem
that was left open in the literature (Chi and Geman,
1998); see again Section 1 for discussion. Let C and
C be defined as in Section 3. We define the empiri-
cal distribution of C as
</bodyText>
<equation confidence="0.9938915">
pC(w) = f(w, C)
|C |. (20)
</equation>
<bodyText confidence="0.982786857142857">
Let G = (N, Σ, S, R) be a CFG such that C ⊆
L(G). Let D(C) be the set of all complete deriva-
tions for G that generate sentences in C, that is,
D(C) = {d  |d ∈ D(G), y(d) ∈ C}.
Further, assume some probabilistic extension G =
(G, pG) of G, such that pG(d) &gt; 0 for every d ∈
D(C). We define a distribution over D(C) by
</bodyText>
<equation confidence="0.9620928">
pD(C)(d) = pC(y(d)) · pG(d) (21)
pG(y(d))
It is not difficult to verify that
X pD(C)(d) = 1. (22)
d∈D(C)
</equation>
<bodyText confidence="0.9995336">
We now apply to G the estimator in (12), in order
to obtain a new PCFG Gˆ = (G, ˆpG) that minimizes
the cross-entropy between pD(C) and ˆpG. According
to Lemma 2, we have that Gˆ is a consistent PCFG.
Distribution ˆpG is specified by
</bodyText>
<equation confidence="0.988633333333333">
ˆpG(A → α) =
Pd∈D(C) pD(C)(d)·f(A → α, d)
Pd∈D(C) pD(C)(d)·f(A, d)
P f(y(d),C)
|C |· pG(d)
pG(y(d)) ·f(A → α, d)
d∈D(C)
P f(y(d),C)
|C |· pG(d)
d∈D(C) pG(y(d)) ·f(A, d)
Pw∈C f(w, C)·Py(d)=w pG(w) ·f(A → α, d)
pG(d)
Pw∈C f(w, C)·Py(d)=w pG(w) ·f(A, d)
pG(d)
Pw∈C f(w,C)·EpG(d  |w)f(A → α, d) =Pw∈C f(w, C)·EpG(d  |w)f(A, d) . (23)
</equation>
<bodyText confidence="0.9960202">
Since distribution pG was arbitrarily chosen, sub-
ject to the only restriction that pG(d) &gt; 0 for ev-
ery d ∈ D(C), we have that (23) is the growth
estimator (10) already discussed in Section 3. In
fact, for each w ∈ L(G) and d ∈ D(G), we have
</bodyText>
<equation confidence="0.666814">
pG(d  |w) = pG(d) We conclude with the desired
pG(w) .
</equation>
<bodyText confidence="0.999523">
result, namely that a general form PCFG obtained at
any iteration of the EM method for the unsupervised
MLE is always consistent.
</bodyText>
<sectionHeader confidence="0.997051" genericHeader="method">
6 Conclusions
</sectionHeader>
<bodyText confidence="0.990348115384615">
In this paper we have investigated a number of
methods for the empirical estimation of probabilis-
tic context-free grammars, and have shown that the
resulting grammars have the so-called consistency
property. This property guarantees that all the prob-
ability mass of the grammar is used for the finite
strings it derives. Thus if the grammar is used in
combination with other probabilistic models, as for
instance in a speech processing system, consistency
allows us to combine or compare scores from differ-
ent modules in a sound way.
To obtain our results, we have used a novel proof
technique that exploits an already known construc-
tion for the renormalization of probabilistic context-
free grammars. Our proof technique seems more
intuitive than arguments previously used in the lit-
erature to prove the consistency property, based on
counting arguments or on spectral analysis. It is
not difficult to see that our proof technique can
also be used with probabilistic rewriting formalisms
whose underlying derivations can be characterized
by means of context-free rewriting. This is for
instance the case with probabilistic tree-adjoining
grammars (Schabes, 1992; Sarkar, 1998), for which
consistency results have not yet been shown in the
literature.
</bodyText>
<sectionHeader confidence="0.65628" genericHeader="method">
A Cross-entropy minimization
</sectionHeader>
<bodyText confidence="0.999748">
In order to make this paper self-contained, we sketch
a proof of the claim in Section 3 that the estimator
in (12) minimizes the cross entropy in (11). A full
proof appears in (Corazza and Satta, 2006).
Let D, pD and G = (N, Σ, R, S) be defined as
in Section 3. We want to find a proper PCFG G =
(G, pG) such that the cross-entropy H(pD  ||pG) is
minimal. We use Lagrange multipliers λA for each
A ∈ N and define the form
</bodyText>
<equation confidence="0.736223">
∇ = X λA · ( X pG(A → α) − 1) +
A∈N α
=
348
E− pD(d) · log pG(d). (24)
d∈D
</equation>
<bodyText confidence="0.973847">
We now consider all the partial derivatives of ∇. For
each A ∈ N we have
</bodyText>
<equation confidence="0.9992316">
pG(A → α) − 1. (25)
For each (A → α) ∈ R we have
∂∇
∂pG(A → α)
∂ E
= λA − pD(d) · log pG(d)
∂pG(A → α) d∈D
∂
pD(d) · ∂pG(A → α) log pG(d)
∂
pD(d) ·
∂pG(A → α)
log 11 pG(B → β)f(B→β,d)
(B→β)∈R
= λA −
d∈D
E pD(d) · ∂pG(A → α)
∂
E f(B → β, d) · logpG(B → β)
(B→β)∈R
</equation>
<bodyText confidence="0.965886">
We sum over all strings α such that (A → α) ∈ R,
deriving
</bodyText>
<equation confidence="0.961895659574468">
λA · ln(2) · E pG(A → α) =
α
E= EpD f(A → α, d)
α
E= E pD(d) · f(A → α, d)
α d∈D
E= pD(d) · E f(A → α, d)
d∈D α
E= pD(d) · f(A, d)
d∈D
= EpD f(A, d). (28)
From each equation ∂∇
∂λA = 0 we obtain
Eα pG(A → α) = 1 for each A ∈ N (our original
constraints). Combining this with (28) we obtain
λA · ln(2) = EpD f(A, d). (29)
Replacing (29) into (27) we obtain, for every rule
(A → α) ∈ R,
EpD f(A → α, d)
pG(A → α) = EpD f(A,d) . (30)
This is the estimator introduced in Section 3.
E=
α
∂∇
∂λA
= λA − E
d∈D
= λA − E
d∈D
= λA − E pD(d) · E f(B → β, d) ·
d∈D (B→β)∈R
∂ log pG(B → β)
∂pG(A → α)
pD(d) · f(A → α, d) ·
1
pG(A → α)
λA −
ln(2)
1 · pG(A → α) ·
1
E· pD(d) · f(A → α, d)
d∈D
λA −
ln(2)
1 · pG(A → α) ·
1
· EpD f(A → α, d). (26)
</equation>
<bodyText confidence="0.945647">
By setting to zero all of the above partial derivatives,
we obtain a system of |N|+|R |equations, which we
must solve. From ∂∇
</bodyText>
<equation confidence="0.998127">
∂pG(A→α) = 0 we obtain
λA · ln(2) · pG(A → α) =
EpDf(A → α, d). (27)
</equation>
<sectionHeader confidence="0.998329" genericHeader="references">
References
</sectionHeader>
<reference confidence="0.99906045">
S. Abney, D. McAllester, and F. Pereira. 1999. Relating
probabilistic grammars and automata. In 37th Annual
Meeting of the Association for Computational Linguis-
tics, Proceedings of the Conference, pages 542–549,
Maryland, USA, June.
L. E. Baum. 1972. An inequality and associated max-
imization technique in statistical estimations of prob-
abilistic functions of Markov processes. Inequalities,
3:1–8.
T.L. Booth and R.A. Thompson. 1973. Applying prob-
abilistic measures to abstract languages. IEEE Trans-
actions on Computers, C-22(5):442–450, May.
E. Charniak. 1993. Statistical Language Learning. MIT
Press.
R. Chaudhuri, S. Pham, and O. N. Garcia. 1983. Solution
of an open problem on probabilistic grammars. IEEE
Transactions on Computers, 32(8):748–750.
Z. Chi and S. Geman. 1998. Estimation of probabilis-
tic context-free grammars. Computational Linguistics,
24(2):299–305.
</reference>
<equation confidence="0.4966238">
E
= λA −
d∈D
1
· ln(2) ·
</equation>
<page confidence="0.992922">
349
</page>
<reference confidence="0.9995715625">
Z. Chi. 1999. Statistical properties of probabilistic
context-free grammars. Computational Linguistics,
25(1):131–160.
A. Corazza and G. Satta. 2006. Cross-entropy and es-
timation of probabilistic context-free grammars. In
Proc. of HLT/NAACL 2006 Conference (this volume),
New York.
A. P. Dempster, N. M. Laird, and D. B. Rubin. 1977.
Maximum likelihood from incomplete data via the EM
algorithm. Journal of the Royal Statistical Society, B,
39:1–38.
J.E. Hopcroft and J.D. Ullman. 1979. Introduction
to Automata Theory, Languages, and Computation.
Addison-Wesley.
M.-J. Nederhof and G. Satta. 2003. Probabilistic pars-
ing as intersection. In 8th International Workshop on
Parsing Technologies, pages 137–148, LORIA, Nancy,
France, April.
J.-A. S´anchez and J.-M. Benedi. 1997. Consistency
of stochastic context-free grammars from probabilis-
tic estimation based on growth transformations. IEEE
Transactions on Pattern Analysis and Machine Intelli-
gence, 19(9):1052–1055, September.
A. Sarkar. 1998. Conditions on consistency of proba-
bilistic tree adjoining grammars. In Proc. of the 36th
ACL, pages 1164–1170, Montreal, Canada.
Y. Schabes. 1992. Stochastic lexicalized tree-adjoining
grammars. In Proc. of the 14th COLING, pages 426–
432, Nantes, France.
C. S. Wetherell. 1980. Probabilistic languages: A re-
view and some open questions. Computing Surveys,
12(4):361–379.
</reference>
<page confidence="0.99767">
350
</page>
</variant>
</algorithm>
<algorithm name="ParsHed" version="110505">
<variant no="0" confidence="0.057285">
<title confidence="0.932992">Estimation of Consistent Probabilistic Context-free Grammars Mark-Jan</title>
<author confidence="0.998499">Max Planck</author>
<title confidence="0.417455">for</title>
<author confidence="0.926377">P O Box</author>
<note confidence="0.3297295">NL-6500 AH The</note>
<email confidence="0.72457">MarkJan.Nederhof@mpi.nl</email>
<abstract confidence="0.998763466666667">We consider several empirical estimators for probabilistic context-free grammars, and show that the estimated grammars have the so-called consistency property, under the most general conditions. Our estimators include the widely applied expectation maximization method, used to estimate probabilistic context-free grammars on the basis of unannotated corpora. This solves a problem left open in the literature, since for this method the consistency property has been shown only under restrictive assumptions on the rules of the source grammar.</abstract>
</variant>
</algorithm>
<algorithm name="ParsCit" version="110505">
<citationList>
<citation valid="true">
<authors>
<author>S Abney</author>
<author>D McAllester</author>
<author>F Pereira</author>
</authors>
<title>Relating probabilistic grammars and automata.</title>
<date>1999</date>
<booktitle>In 37th Annual Meeting of the Association for Computational Linguistics, Proceedings of the Conference,</booktitle>
<pages>542--549</pages>
<location>Maryland, USA,</location>
<contexts>
<context position="13006" citStr="Abney et al., 1999" startWordPosition="2428" endWordPosition="2431">g the estimator in (12) to pD, we obtain pG(A → α) = EdED pD(d) · f(A → α, d) EdED pD(d) · f(A, d) EdED f (D�) · f (A → α, d) EdED f (D;) · f (A, d) EdED f(d, D) · f(A → α, d) (14) EdED f (d, D) · f (A, d) This is the supervised MLE estimator in (7). This reminds us of the well-known fact that maximizing the likelihood of a (finite) sample through a PCFG distribution amounts to minimizing the cross-entropy between the empirical distribution of the sample and the PCFG distribution itself. 4 Renormalization In this section we recall a renormalization technique for PCFGs that was used before in (Abney et al., 1999), (Chi, 1999) and (Nederhof and Satta, 2003) for different purposes, and is exploited in the next section to prove our main results. In the remainder of this section, we assume a fixed, not necessarily proper PCFG G = (G, pG), with G = (N, Σ, S, R). We define the renormalization of G as the PCFG R(G) = (G, p7z) with p7z specified by p7z(A → α) = Ed,w pG(α d ⇒w) pG(A → α) · . (15) Ed,w pG(A ⇒d w) It is not difficult to see that R(G) is a proper PCFG. We now show an important property of R(G), discussed before in (Nederhof and Satta, 2003) in the context of so-called weighted context-free gramma</context>
</contexts>
<marker>Abney, McAllester, Pereira, 1999</marker>
<rawString>S. Abney, D. McAllester, and F. Pereira. 1999. Relating probabilistic grammars and automata. In 37th Annual Meeting of the Association for Computational Linguistics, Proceedings of the Conference, pages 542–549, Maryland, USA, June.</rawString>
</citation>
<citation valid="true">
<authors>
<author>L E Baum</author>
</authors>
<title>An inequality and associated maximization technique in statistical estimations of probabilistic functions of Markov processes.</title>
<date>1972</date>
<journal>Inequalities,</journal>
<volume>3</volume>
<contexts>
<context position="9994" citStr="Baum, 1972" startWordPosition="1862" endWordPosition="1863">imum. (A point with partial derivatives of zero that is not a local maximum could be a local minimum or even a so-called saddle point.) In practice, this system is typically solved by means of an iterative algorithm called inside/outside (Charniak, 1993), which implements the expectation maximization (EM) method (Dempster et al., 1977). Starting with an initial function pG that probabilistically extends G, a so-called growth transformation is computed, defined as pG(A → α) = r ( pG(d) G-�wEC f lw, C)· Py(d)=w pG(w) f (A α, d) EWEC 10) pG(d) (AlAd) G-�wEG f (w, C)· Py(d)=w f PG(w) ` Following (Baum, 1972), one can show that pG(C) ≥ pG(C). Thus, by iterating the growth transformation above, we are guaranteed to reach a local maximum for (8), or possibly a saddle point. We refer to this as the unsupervised MLE method. We now discuss a third estimation method for PCFGs, which was proposed in (Corazza and Satta, 2006). This method can be viewed as a generalization of the supervised MLE method to probability distributions defined over infinite sets of complete derivations. Let D be an infinite set of complete derivations using nonterminal symbols in N, start symbol S E N and terminal symbols in Σ. </context>
</contexts>
<marker>Baum, 1972</marker>
<rawString>L. E. Baum. 1972. An inequality and associated maximization technique in statistical estimations of probabilistic functions of Markov processes. Inequalities, 3:1–8.</rawString>
</citation>
<citation valid="true">
<authors>
<author>T L Booth</author>
<author>R A Thompson</author>
</authors>
<title>Applying probabilistic measures to abstract languages.</title>
<date>1973</date>
<journal>IEEE Transactions on Computers,</journal>
<volume>22</volume>
<issue>5</issue>
<publisher>MIT Press.</publisher>
<contexts>
<context position="4229" citStr="Booth and Thompson, 1973" startWordPosition="652" endWordPosition="655">free grammars, which has been used in the context of language modeling. The structure of this paper is as follows. We provide some preliminary definitions in Section 2, followed in Section 3 by a brief overview of the estimation methods we investigate in this paper. In Section 4 we prove some properties of a renormalization technique for probabilistic context-free grammars, and use this property to show our main results in Section 5. Section 6 closes with some concluding remarks. 2 Preliminaries In this paper we use mostly standard notation, as for instance in (Hopcroft and Ullman, 1979) and (Booth and Thompson, 1973), which we summarize below. A context-free grammar (CFG) is a 4-tuple G = (N, E, 5, R) where N and E are finite disjoint sets of nonterminal and terminal symbols, respectively, 5 ∈ N is the start symbol and R is a finite set of rules. Each rule has the form A → α, where A ∈ N and α ∈ (E ∪ N)*. We write V for set E ∪ N. Each CFG G is associated with a left-most derive relation ⇒, defined on triples consisting of two strings -y, 6 ∈ V* and a rule 7r ∈ R. We write -y π⇒ 6 if and only if -y = uA-y&apos; and 6 = uα-y&apos;, for some u ∈ E*, -y&apos; ∈ V *, and 7r = (A → α). A leftmost derivation for G is a string</context>
</contexts>
<marker>Booth, Thompson, 1973</marker>
<rawString>T.L. Booth and R.A. Thompson. 1973. Applying probabilistic measures to abstract languages. IEEE Transactions on Computers, C-22(5):442–450, May. E. Charniak. 1993. Statistical Language Learning. MIT Press.</rawString>
</citation>
<citation valid="true">
<authors>
<author>R Chaudhuri</author>
<author>S Pham</author>
<author>O N Garcia</author>
</authors>
<title>Solution of an open problem on probabilistic grammars.</title>
<date>1983</date>
<journal>IEEE Transactions on Computers,</journal>
<volume>32</volume>
<issue>8</issue>
<contexts>
<context position="1895" citStr="Chaudhuri et al., 1983" startWordPosition="276" endWordPosition="279">irical estimation of probabilistic context-free grammars have been proposed in the literature, based on the optimization of some function on the probabilities of the observed data, such as the maximization of the likelihood of Giorgio Satta Dept. of Information Engineering University of Padua via Gradenigo, 6/A I-35131 Padova Italy satta@dei.unipd.it a tree bank or a corpus of unannotated sentences. It has been conjectured in (Wetherell, 1980) that these methods always provide probabilistic context-free grammars with the consistency property. A first result in this direction was presented in (Chaudhuri et al., 1983), by showing that a probabilistic contextfree grammar estimated by maximizing the likelihood of a sample of parse trees is always consistent. In later work by (S´anchez and Benedi, 1997) and (Chi and Geman, 1998), the result was independently extended to expectation maximization, which is an unsupervised method exploited to estimate probabilistic context-free grammars by finding local maxima of the likelihood of a sample of unannotated sentences. The proof in (S´anchez and Benedi, 1997) makes use of spectral analysis of expectation matrices, while the proof in (Chi and Geman, 1998) is based on</context>
<context position="17254" citStr="Chaudhuri et al., 1983" startWordPosition="3349" endWordPosition="3352">fined for probability distributions.) Lemma 2 directly implies that the cross-entropy minimization method in (12) always provides a consistent PCFG, since it minimizes cross-entropy for a distribution defined over a subset of D(G). We have already seen in Section 3 that the supervised MLE method is a special case of the cross-entropy minimization method. Thus we can also conclude that a PCFG trained with the supervised MLE method is pR(Ai ⇒ wi) d� � q i=1 77q77 ·11 i=1 � q · i=1 · �= d,w = 1. (18) 347 always consistent. This provides an alternative proof of a property that was first shown in (Chaudhuri et al., 1983), as discussed in Section 1. We now prove the same result for the unsupervised MLE method, without any restrictive assumption on the rules of our CFGs. This solves a problem that was left open in the literature (Chi and Geman, 1998); see again Section 1 for discussion. Let C and C be defined as in Section 3. We define the empirical distribution of C as pC(w) = f(w, C) |C |. (20) Let G = (N, Σ, S, R) be a CFG such that C ⊆ L(G). Let D(C) be the set of all complete derivations for G that generate sentences in C, that is, D(C) = {d |d ∈ D(G), y(d) ∈ C}. Further, assume some probabilistic extensio</context>
</contexts>
<marker>Chaudhuri, Pham, Garcia, 1983</marker>
<rawString>R. Chaudhuri, S. Pham, and O. N. Garcia. 1983. Solution of an open problem on probabilistic grammars. IEEE Transactions on Computers, 32(8):748–750.</rawString>
</citation>
<citation valid="true">
<authors>
<author>Z Chi</author>
<author>S Geman</author>
</authors>
<title>Estimation of probabilistic context-free grammars.</title>
<date>1998</date>
<journal>Computational Linguistics,</journal>
<volume>24</volume>
<issue>2</issue>
<contexts>
<context position="2107" citStr="Chi and Geman, 1998" startWordPosition="312" endWordPosition="315">kelihood of Giorgio Satta Dept. of Information Engineering University of Padua via Gradenigo, 6/A I-35131 Padova Italy satta@dei.unipd.it a tree bank or a corpus of unannotated sentences. It has been conjectured in (Wetherell, 1980) that these methods always provide probabilistic context-free grammars with the consistency property. A first result in this direction was presented in (Chaudhuri et al., 1983), by showing that a probabilistic contextfree grammar estimated by maximizing the likelihood of a sample of parse trees is always consistent. In later work by (S´anchez and Benedi, 1997) and (Chi and Geman, 1998), the result was independently extended to expectation maximization, which is an unsupervised method exploited to estimate probabilistic context-free grammars by finding local maxima of the likelihood of a sample of unannotated sentences. The proof in (S´anchez and Benedi, 1997) makes use of spectral analysis of expectation matrices, while the proof in (Chi and Geman, 1998) is based on a simpler counting argument. Both these proofs assume restrictions on the underlying context-free grammars. More specifically, in (Chi and Geman, 1998) empty rules and unary rules are not allowed, thus excluding</context>
<context position="7997" citStr="Chi and Geman, 1998" startWordPosition="1470" endWordPosition="1473"> is, the number of occurrences of d in D. We define f(A → α, D) = X f(d, D) · f(A → α, d), (5) dED and let f(A, D) = Pα f(A → α, D). Consider a CFG G = (N, Σ, R, S) defined by all and only the nonterminals, terminals and rules observed in D. The criterion of maximum likelihood estimation (MLE) prescribes the construction of a PCFG G = (G, pG) such that pG maximizes the likelihood of D, defined as pG(D) = Y pG(d)f(d,D), (6) dED subject to the properness conditions Pα pG(A → α) = 1 for each A E N. The maximization problem above has a unique solution, provided by the estimator (see for instance (Chi and Geman, 1998)) pG(A → α) = f(A → α, D). (7) f (A, D) We refer to this as the supervised MLE method. In applications in which a tree bank is not available, one might still use the MLE criterion to train a PCFG in an unsupervised way, on the basis of a sample of unannotated sentences, also called a corpus. Let us call C such a sample and C the underlying set of sentences. For w E C, we let f(w, C) be the multiplicity of w in C. Assume a CFG G = (N, Σ, R, S) that is able to generate all of the sentences in C, and possibly more. The MLE criterion prescribes the construction of a PCFG G = (G, pG) such that pG m</context>
<context position="17486" citStr="Chi and Geman, 1998" startWordPosition="3392" endWordPosition="3395">have already seen in Section 3 that the supervised MLE method is a special case of the cross-entropy minimization method. Thus we can also conclude that a PCFG trained with the supervised MLE method is pR(Ai ⇒ wi) d� � q i=1 77q77 ·11 i=1 � q · i=1 · �= d,w = 1. (18) 347 always consistent. This provides an alternative proof of a property that was first shown in (Chaudhuri et al., 1983), as discussed in Section 1. We now prove the same result for the unsupervised MLE method, without any restrictive assumption on the rules of our CFGs. This solves a problem that was left open in the literature (Chi and Geman, 1998); see again Section 1 for discussion. Let C and C be defined as in Section 3. We define the empirical distribution of C as pC(w) = f(w, C) |C |. (20) Let G = (N, Σ, S, R) be a CFG such that C ⊆ L(G). Let D(C) be the set of all complete derivations for G that generate sentences in C, that is, D(C) = {d |d ∈ D(G), y(d) ∈ C}. Further, assume some probabilistic extension G = (G, pG) of G, such that pG(d) &gt; 0 for every d ∈ D(C). We define a distribution over D(C) by pD(C)(d) = pC(y(d)) · pG(d) (21) pG(y(d)) It is not difficult to verify that X pD(C)(d) = 1. (22) d∈D(C) We now apply to G the estimat</context>
</contexts>
<marker>Chi, Geman, 1998</marker>
<rawString>Z. Chi and S. Geman. 1998. Estimation of probabilistic context-free grammars. Computational Linguistics, 24(2):299–305.</rawString>
</citation>
<citation valid="true">
<authors>
<author>Z Chi</author>
</authors>
<title>Statistical properties of probabilistic context-free grammars.</title>
<date>1999</date>
<journal>Computational Linguistics,</journal>
<volume>25</volume>
<issue>1</issue>
<contexts>
<context position="13019" citStr="Chi, 1999" startWordPosition="2432" endWordPosition="2433">) to pD, we obtain pG(A → α) = EdED pD(d) · f(A → α, d) EdED pD(d) · f(A, d) EdED f (D�) · f (A → α, d) EdED f (D;) · f (A, d) EdED f(d, D) · f(A → α, d) (14) EdED f (d, D) · f (A, d) This is the supervised MLE estimator in (7). This reminds us of the well-known fact that maximizing the likelihood of a (finite) sample through a PCFG distribution amounts to minimizing the cross-entropy between the empirical distribution of the sample and the PCFG distribution itself. 4 Renormalization In this section we recall a renormalization technique for PCFGs that was used before in (Abney et al., 1999), (Chi, 1999) and (Nederhof and Satta, 2003) for different purposes, and is exploited in the next section to prove our main results. In the remainder of this section, we assume a fixed, not necessarily proper PCFG G = (G, pG), with G = (N, Σ, S, R). We define the renormalization of G as the PCFG R(G) = (G, p7z) with p7z specified by p7z(A → α) = Ed,w pG(α d ⇒w) pG(A → α) · . (15) Ed,w pG(A ⇒d w) It is not difficult to see that R(G) is a proper PCFG. We now show an important property of R(G), discussed before in (Nederhof and Satta, 2003) in the context of so-called weighted context-free grammars. Lemma 1 F</context>
</contexts>
<marker>Chi, 1999</marker>
<rawString>Z. Chi. 1999. Statistical properties of probabilistic context-free grammars. Computational Linguistics, 25(1):131–160.</rawString>
</citation>
<citation valid="true">
<authors>
<author>A Corazza</author>
<author>G Satta</author>
</authors>
<title>Cross-entropy and estimation of probabilistic context-free grammars.</title>
<date>2006</date>
<booktitle>In Proc. of HLT/NAACL 2006 Conference (this volume),</booktitle>
<location>New York.</location>
<contexts>
<context position="10309" citStr="Corazza and Satta, 2006" startWordPosition="1916" endWordPosition="1919">(EM) method (Dempster et al., 1977). Starting with an initial function pG that probabilistically extends G, a so-called growth transformation is computed, defined as pG(A → α) = r ( pG(d) G-�wEC f lw, C)· Py(d)=w pG(w) f (A α, d) EWEC 10) pG(d) (AlAd) G-�wEG f (w, C)· Py(d)=w f PG(w) ` Following (Baum, 1972), one can show that pG(C) ≥ pG(C). Thus, by iterating the growth transformation above, we are guaranteed to reach a local maximum for (8), or possibly a saddle point. We refer to this as the unsupervised MLE method. We now discuss a third estimation method for PCFGs, which was proposed in (Corazza and Satta, 2006). This method can be viewed as a generalization of the supervised MLE method to probability distributions defined over infinite sets of complete derivations. Let D be an infinite set of complete derivations using nonterminal symbols in N, start symbol S E N and terminal symbols in Σ. We assume that the set of rules that are observed in D is drawn from some finite set R. Let pD be a probability distribution defined over D, that is, a function from set D to interval [0, 1] such that PdED pD(d) = 1. Consider the CFG G = (N, Σ, R, S). Note that D ⊆ D(G). We wish to extend G to some PCFG G = (G, pG</context>
<context position="11893" citStr="Corazza and Satta, 2006" startWordPosition="2221" endWordPosition="2224">t is �= − pD(d) · log pG(d). (11) dED We thus want to assign to the parameters pG(A → α), A → α ∈ R, the values that minimize (11), subject to the conditions Eα pG(A → α) = 1 for each A ∈ N. Note that minimization of the cross-entropy above is equivalent to minimization of the KullbackLeibler distance between pD and pG. Also note that the likelihood of an infinite set of derivations would always be zero and therefore cannot be considered here. The solution to the above minimization problem provides the estimator EpD f(A → α, d) pG(A → α) = EpD f(A, d) . (12) A proof of this result appears in (Corazza and Satta, 2006), and is briefly summarized in Appendix A, in order to make this paper self-contained. We call the above estimator the cross-entropy minimization method. The cross-entropy minimization method can be viewed as a generalization of the supervised MLE method in (7), as shown in what follows. Let D and D be defined as for the supervised MLE method. We define a distribution over D as pD(d) = f(d, D) |D |.(13) Distribution pD is usually called the empirical distribution associated with D. Applying the estimator in (12) to pD, we obtain pG(A → α) = EdED pD(d) · f(A → α, d) EdED pD(d) · f(A, d) EdED f </context>
<context position="20539" citStr="Corazza and Satta, 2006" startWordPosition="3940" endWordPosition="3943">on spectral analysis. It is not difficult to see that our proof technique can also be used with probabilistic rewriting formalisms whose underlying derivations can be characterized by means of context-free rewriting. This is for instance the case with probabilistic tree-adjoining grammars (Schabes, 1992; Sarkar, 1998), for which consistency results have not yet been shown in the literature. A Cross-entropy minimization In order to make this paper self-contained, we sketch a proof of the claim in Section 3 that the estimator in (12) minimizes the cross entropy in (11). A full proof appears in (Corazza and Satta, 2006). Let D, pD and G = (N, Σ, R, S) be defined as in Section 3. We want to find a proper PCFG G = (G, pG) such that the cross-entropy H(pD ||pG) is minimal. We use Lagrange multipliers λA for each A ∈ N and define the form ∇ = X λA · ( X pG(A → α) − 1) + A∈N α = 348 E− pD(d) · log pG(d). (24) d∈D We now consider all the partial derivatives of ∇. For each A ∈ N we have pG(A → α) − 1. (25) For each (A → α) ∈ R we have ∂∇ ∂pG(A → α) ∂ E = λA − pD(d) · log pG(d) ∂pG(A → α) d∈D ∂ pD(d) · ∂pG(A → α) log pG(d) ∂ pD(d) · ∂pG(A → α) log 11 pG(B → β)f(B→β,d) (B→β)∈R = λA − d∈D E pD(d) · ∂pG(A → α) ∂ E f(B </context>
</contexts>
<marker>Corazza, Satta, 2006</marker>
<rawString>A. Corazza and G. Satta. 2006. Cross-entropy and estimation of probabilistic context-free grammars. In Proc. of HLT/NAACL 2006 Conference (this volume), New York.</rawString>
</citation>
<citation valid="true">
<authors>
<author>A P Dempster</author>
<author>N M Laird</author>
<author>D B Rubin</author>
</authors>
<title>Maximum likelihood from incomplete data via the EM algorithm.</title>
<date>1977</date>
<journal>Journal of the Royal Statistical Society, B,</journal>
<pages>39--1</pages>
<contexts>
<context position="9720" citStr="Dempster et al., 1977" startWordPosition="1808" endWordPosition="1811">f y(d) = w). The solution to the above system is not unique, because of the nonlinearity. Furthermore, each solution of (9) identifies a point where the curve in (8) has partial derivatives of zero, but this does not necessarily correspond to a local maximum, let alone an absolute maximum. (A point with partial derivatives of zero that is not a local maximum could be a local minimum or even a so-called saddle point.) In practice, this system is typically solved by means of an iterative algorithm called inside/outside (Charniak, 1993), which implements the expectation maximization (EM) method (Dempster et al., 1977). Starting with an initial function pG that probabilistically extends G, a so-called growth transformation is computed, defined as pG(A → α) = r ( pG(d) G-�wEC f lw, C)· Py(d)=w pG(w) f (A α, d) EWEC 10) pG(d) (AlAd) G-�wEG f (w, C)· Py(d)=w f PG(w) ` Following (Baum, 1972), one can show that pG(C) ≥ pG(C). Thus, by iterating the growth transformation above, we are guaranteed to reach a local maximum for (8), or possibly a saddle point. We refer to this as the unsupervised MLE method. We now discuss a third estimation method for PCFGs, which was proposed in (Corazza and Satta, 2006). This meth</context>
</contexts>
<marker>Dempster, Laird, Rubin, 1977</marker>
<rawString>A. P. Dempster, N. M. Laird, and D. B. Rubin. 1977. Maximum likelihood from incomplete data via the EM algorithm. Journal of the Royal Statistical Society, B, 39:1–38.</rawString>
</citation>
<citation valid="true">
<authors>
<author>J E Hopcroft</author>
<author>J D Ullman</author>
</authors>
<title>Introduction to Automata Theory, Languages, and Computation.</title>
<date>1979</date>
<publisher>Addison-Wesley.</publisher>
<contexts>
<context position="4198" citStr="Hopcroft and Ullman, 1979" startWordPosition="647" endWordPosition="650">ction for probabilistic context-free grammars, which has been used in the context of language modeling. The structure of this paper is as follows. We provide some preliminary definitions in Section 2, followed in Section 3 by a brief overview of the estimation methods we investigate in this paper. In Section 4 we prove some properties of a renormalization technique for probabilistic context-free grammars, and use this property to show our main results in Section 5. Section 6 closes with some concluding remarks. 2 Preliminaries In this paper we use mostly standard notation, as for instance in (Hopcroft and Ullman, 1979) and (Booth and Thompson, 1973), which we summarize below. A context-free grammar (CFG) is a 4-tuple G = (N, E, 5, R) where N and E are finite disjoint sets of nonterminal and terminal symbols, respectively, 5 ∈ N is the start symbol and R is a finite set of rules. Each rule has the form A → α, where A ∈ N and α ∈ (E ∪ N)*. We write V for set E ∪ N. Each CFG G is associated with a left-most derive relation ⇒, defined on triples consisting of two strings -y, 6 ∈ V* and a rule 7r ∈ R. We write -y π⇒ 6 if and only if -y = uA-y&apos; and 6 = uα-y&apos;, for some u ∈ E*, -y&apos; ∈ V *, and 7r = (A → α). A leftmo</context>
</contexts>
<marker>Hopcroft, Ullman, 1979</marker>
<rawString>J.E. Hopcroft and J.D. Ullman. 1979. Introduction to Automata Theory, Languages, and Computation. Addison-Wesley.</rawString>
</citation>
<citation valid="true">
<authors>
<author>M-J Nederhof</author>
<author>G Satta</author>
</authors>
<title>Probabilistic parsing as intersection.</title>
<date>2003</date>
<booktitle>In 8th International Workshop on Parsing Technologies,</booktitle>
<pages>137--148</pages>
<location>LORIA, Nancy, France,</location>
<contexts>
<context position="13050" citStr="Nederhof and Satta, 2003" startWordPosition="2435" endWordPosition="2438">in pG(A → α) = EdED pD(d) · f(A → α, d) EdED pD(d) · f(A, d) EdED f (D�) · f (A → α, d) EdED f (D;) · f (A, d) EdED f(d, D) · f(A → α, d) (14) EdED f (d, D) · f (A, d) This is the supervised MLE estimator in (7). This reminds us of the well-known fact that maximizing the likelihood of a (finite) sample through a PCFG distribution amounts to minimizing the cross-entropy between the empirical distribution of the sample and the PCFG distribution itself. 4 Renormalization In this section we recall a renormalization technique for PCFGs that was used before in (Abney et al., 1999), (Chi, 1999) and (Nederhof and Satta, 2003) for different purposes, and is exploited in the next section to prove our main results. In the remainder of this section, we assume a fixed, not necessarily proper PCFG G = (G, pG), with G = (N, Σ, S, R). We define the renormalization of G as the PCFG R(G) = (G, p7z) with p7z specified by p7z(A → α) = Ed,w pG(α d ⇒w) pG(A → α) · . (15) Ed,w pG(A ⇒d w) It is not difficult to see that R(G) is a proper PCFG. We now show an important property of R(G), discussed before in (Nederhof and Satta, 2003) in the context of so-called weighted context-free grammars. Lemma 1 For each derivation d with A ⇒d </context>
</contexts>
<marker>Nederhof, Satta, 2003</marker>
<rawString>M.-J. Nederhof and G. Satta. 2003. Probabilistic parsing as intersection. In 8th International Workshop on Parsing Technologies, pages 137–148, LORIA, Nancy, France, April.</rawString>
</citation>
<citation valid="true">
<authors>
<author>J-A S´anchez</author>
<author>J-M Benedi</author>
</authors>
<title>Consistency of stochastic context-free grammars from probabilistic estimation based on growth transformations.</title>
<date>1997</date>
<journal>IEEE Transactions on Pattern Analysis and Machine Intelligence,</journal>
<volume>19</volume>
<issue>9</issue>
<marker>S´anchez, Benedi, 1997</marker>
<rawString>J.-A. S´anchez and J.-M. Benedi. 1997. Consistency of stochastic context-free grammars from probabilistic estimation based on growth transformations. IEEE Transactions on Pattern Analysis and Machine Intelligence, 19(9):1052–1055, September.</rawString>
</citation>
<citation valid="true">
<authors>
<author>A Sarkar</author>
</authors>
<title>Conditions on consistency of probabilistic tree adjoining grammars.</title>
<date>1998</date>
<booktitle>In Proc. of the 36th ACL,</booktitle>
<pages>1164--1170</pages>
<location>Montreal, Canada.</location>
<contexts>
<context position="20234" citStr="Sarkar, 1998" startWordPosition="3890" endWordPosition="3891">e used a novel proof technique that exploits an already known construction for the renormalization of probabilistic contextfree grammars. Our proof technique seems more intuitive than arguments previously used in the literature to prove the consistency property, based on counting arguments or on spectral analysis. It is not difficult to see that our proof technique can also be used with probabilistic rewriting formalisms whose underlying derivations can be characterized by means of context-free rewriting. This is for instance the case with probabilistic tree-adjoining grammars (Schabes, 1992; Sarkar, 1998), for which consistency results have not yet been shown in the literature. A Cross-entropy minimization In order to make this paper self-contained, we sketch a proof of the claim in Section 3 that the estimator in (12) minimizes the cross entropy in (11). A full proof appears in (Corazza and Satta, 2006). Let D, pD and G = (N, Σ, R, S) be defined as in Section 3. We want to find a proper PCFG G = (G, pG) such that the cross-entropy H(pD ||pG) is minimal. We use Lagrange multipliers λA for each A ∈ N and define the form ∇ = X λA · ( X pG(A → α) − 1) + A∈N α = 348 E− pD(d) · log pG(d). (24) d∈D </context>
</contexts>
<marker>Sarkar, 1998</marker>
<rawString>A. Sarkar. 1998. Conditions on consistency of probabilistic tree adjoining grammars. In Proc. of the 36th ACL, pages 1164–1170, Montreal, Canada.</rawString>
</citation>
<citation valid="true">
<authors>
<author>Y Schabes</author>
</authors>
<title>Stochastic lexicalized tree-adjoining grammars.</title>
<date>1992</date>
<booktitle>In Proc. of the 14th COLING,</booktitle>
<pages>426--432</pages>
<location>Nantes, France.</location>
<contexts>
<context position="20219" citStr="Schabes, 1992" startWordPosition="3888" endWordPosition="3889">results, we have used a novel proof technique that exploits an already known construction for the renormalization of probabilistic contextfree grammars. Our proof technique seems more intuitive than arguments previously used in the literature to prove the consistency property, based on counting arguments or on spectral analysis. It is not difficult to see that our proof technique can also be used with probabilistic rewriting formalisms whose underlying derivations can be characterized by means of context-free rewriting. This is for instance the case with probabilistic tree-adjoining grammars (Schabes, 1992; Sarkar, 1998), for which consistency results have not yet been shown in the literature. A Cross-entropy minimization In order to make this paper self-contained, we sketch a proof of the claim in Section 3 that the estimator in (12) minimizes the cross entropy in (11). A full proof appears in (Corazza and Satta, 2006). Let D, pD and G = (N, Σ, R, S) be defined as in Section 3. We want to find a proper PCFG G = (G, pG) such that the cross-entropy H(pD ||pG) is minimal. We use Lagrange multipliers λA for each A ∈ N and define the form ∇ = X λA · ( X pG(A → α) − 1) + A∈N α = 348 E− pD(d) · log p</context>
</contexts>
<marker>Schabes, 1992</marker>
<rawString>Y. Schabes. 1992. Stochastic lexicalized tree-adjoining grammars. In Proc. of the 14th COLING, pages 426– 432, Nantes, France.</rawString>
</citation>
<citation valid="true">
<authors>
<author>C S Wetherell</author>
</authors>
<title>Probabilistic languages: A review and some open questions.</title>
<date>1980</date>
<journal>Computing Surveys,</journal>
<volume>12</volume>
<issue>4</issue>
<contexts>
<context position="1719" citStr="Wetherell, 1980" startWordPosition="252" endWordPosition="253">ings or parse trees that it generates. In other words, the grammar should not lose probability mass with strings or trees of infinite length. Several methods for the empirical estimation of probabilistic context-free grammars have been proposed in the literature, based on the optimization of some function on the probabilities of the observed data, such as the maximization of the likelihood of Giorgio Satta Dept. of Information Engineering University of Padua via Gradenigo, 6/A I-35131 Padova Italy satta@dei.unipd.it a tree bank or a corpus of unannotated sentences. It has been conjectured in (Wetherell, 1980) that these methods always provide probabilistic context-free grammars with the consistency property. A first result in this direction was presented in (Chaudhuri et al., 1983), by showing that a probabilistic contextfree grammar estimated by maximizing the likelihood of a sample of parse trees is always consistent. In later work by (S´anchez and Benedi, 1997) and (Chi and Geman, 1998), the result was independently extended to expectation maximization, which is an unsupervised method exploited to estimate probabilistic context-free grammars by finding local maxima of the likelihood of a sample</context>
</contexts>
<marker>Wetherell, 1980</marker>
<rawString>C. S. Wetherell. 1980. Probabilistic languages: A review and some open questions. Computing Surveys, 12(4):361–379.</rawString>
</citation>
</citationList>
</algorithm>
</algorithms>